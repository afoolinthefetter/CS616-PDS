**Author:** Aman Gupta (aman.gupta@iitgn.ac.in) (23210122)
**** 
# Assignment 4: Map Reduce using RPC

### Changes in the provided `rpc.zip` file:
- `dos2unix` was used for test-mr* as follows:
   ```bash
   dos2unix test-mr*
   ```
****
## Coordinator

### Initialization:
- **InitWorker**: This method initializes worker arguments by setting `reply.NMap` and `reply.NReduce` based on the coordinator's attributes.

### Task Monitoring:
- **monitorTasks**: This method runs in a separate goroutine and checks the status of map and reduce tasks.
  - It iterates over map and reduce tasks and marks them as idle if they haven't been scheduled for more than 10 seconds.

### Task Assignment:
- **GetTask**: This method assigns tasks to workers.
  - If there are no map tasks remaining, it switches to the reduce phase.
  - If it's the map phase, it assigns a map task to a worker if available.
  - If it's the reduce phase, it assigns a reduce task to a worker if available.

### Task Completion:
- **CommitTask**: This method marks tasks as completed once workers finish processing them.
  - It deletes the completed map or reduce task from the coordinator's task list.
  - If all reduce tasks are completed, it sets `reply.Done` to true.


### Coordination:
- **Done**: This method checks whether all tasks are completed, signaling the end of the MapReduce process.

### Coordinator Creation:
- **MakeCoordinator**: This function initializes a coordinator with map and reduce tasks based on the input files and number of reduce tasks provided.
  - It reads the content of input files and creates map tasks accordingly.
  - It initializes reduce tasks.

****

## Worker

### Initialization:
- It starts by initializing worker arguments by calling `Coordinator.InitWorker`, where it retrieves the number of map tasks (`nMap`) and reduce tasks (`nReduce`) from the coordinator.

### Task Processing Loop:
- It enters an infinite loop where it repeatedly requests tasks from the coordinator using `Coordinator.GetTask`.
- If there are no tasks scheduled, the worker sleeps for a second and then continues to check for tasks.

### Task Execution:
- When a task is scheduled, it retrieves the task details such as `taskId`, `phase` (whether it's a map or reduce phase), `filename`, and `content`.
- If the phase is "map":
  - It calls the `mapf` function with the filename and content to generate key-value pairs.
  - It creates temporary output files for each reduce task.
  - It iterates over the key-value pairs generated by the `mapf` function, calculates the reduce task for each key using `ihash`, and writes the key-value pairs to the corresponding reduce task's output file.
  - It renames the temporary output files to permanent ones.
- If the phase is "reduce":
  - It collects key-value pairs from all map tasks for the given reduce task.
  - It sorts the key-value pairs by key.
  - It creates a temporary output file for the reduce task.
  - It iterates over the sorted key-value pairs, groups values by key, applies the `reducef` function, and writes the results to the output file.

### Task Completion:
- After completing the task, it informs the coordinator by calling `Coordinator.CommitTask`.

### Termination:
- If all tasks are completed (`CommitTaskReply.Done`), the worker exits the loop and terminates.

This function represents the essential behavior of a worker node in a MapReduce system, handling both map and reduce tasks, communicating with the coordinator to receive tasks and report task completion.



